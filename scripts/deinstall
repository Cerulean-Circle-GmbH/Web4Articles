#!/bin/bash

# Web4 ONCE Deinstall Wrapper - Direct access to deinstall functionality
# Location-resilient wrapper for ONCE deinstall command

SCRIPT_DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )"

if [ -z "$PROJECT_ROOT" ]; then
  PROJECT_ROOT="$SCRIPT_DIR"
  while [ "$PROJECT_ROOT" != "/" ]; do
    if [ -f "$PROJECT_ROOT/package.json" ] || [ -d "$PROJECT_ROOT/.git" ]; then
      break
    fi
    PROJECT_ROOT="$(dirname "$PROJECT_ROOT")"
  done
  export PROJECT_ROOT
fi

CURRENT_DIR="$(pwd)"
DEINSTALL_SCRIPT="$PROJECT_ROOT/components/ONCE/0.3.0.0/deinstall"

if [ ! -x "$DEINSTALL_SCRIPT" ]; then
    echo "‚ùå ONCE deinstall script not found at: $DEINSTALL_SCRIPT"
    exit 1
fi

cd "$CURRENT_DIR"
"$DEINSTALL_SCRIPT" "$@"